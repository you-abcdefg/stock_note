<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>ユーザー管理</h1>
    <%= link_to 'ユーザーを追加', new_admin_user_path, class: 'btn btn-primary' %>
  </div>

  <%= search_form_for @q, url: admin_users_path do |f| %>
    <div class="row mb-3">
      <div class="col-md-4">
        <%= f.label :name_cont, 'ユーザー名検索' %>
        <%= f.search_field :name_cont, class: 'form-control', placeholder: '名前で検索' %>
      </div>
      <div class="col-md-4">
        <%= f.label :email_cont, 'メールアドレス検索' %>
        <%= f.search_field :email_cont, class: 'form-control', placeholder: 'メールで検索' %>
      </div>
      <div class="col-md-4">
        <%= f.label :role_eq, '権限' %>
        <%= f.select :role_eq, User.roles.keys.map { |k| [I18n.t("enums.user.role.#{k}"), k] }, { include_blank: '全て' }, class: 'form-control' %>
      </div>
    </div>
    <div class="mb-3">
      <%= f.submit '検索', class: 'btn btn-primary' %>
      <%= link_to 'リセット', admin_users_path, class: 'btn btn-secondary' %>
    </div>
  <% end %>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>名前</th>
        <th>メールアドレス</th>
        <th>権限</th>
        <th>作成日</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody>
      <% @users.each do |user| %>
        <tr>
          <td><%= user.id %></td>
          <td><%= link_to user.name, admin_user_path(user) %></td>
          <td><%= user.email %></td>
          <td>
            <span class="badge badge-<%= user.admin? ? 'danger' : user.general? ? 'primary' : 'secondary' %>">
              <%= I18n.t("enums.user.role.#{user.role}") %>
            </span>
          </td>
          <td><%= user.created_at.strftime('%Y/%m/%d') %></td>
          <td>
            <%= link_to '詳細', admin_user_path(user), class: 'btn btn-sm btn-info' %>
            <%= link_to '編集', edit_admin_user_path(user), class: 'btn btn-sm btn-warning' %>
            <% unless user == current_user %>
              <%= link_to '削除', admin_user_path(user), method: :delete, data: { confirm: '本当に削除しますか？' }, class: 'btn btn-sm btn-danger' %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <%= paginate @users %>
</div>
