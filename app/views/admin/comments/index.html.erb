<div class="container mt-4">
  <h1>コメント管理</h1>

  <%= search_form_for @q, url: admin_comments_path do |f| %>
    <div class="row mb-3">
      <div class="col-md-4">
        <%= f.label :body_cont, 'コメント本文検索' %>
        <%= f.search_field :body_cont, class: 'form-control', placeholder: 'コメント内容で検索' %>
      </div>
      <div class="col-md-4">
        <%= f.label :user_name_cont, 'ユーザー名検索' %>
        <%= f.search_field :user_name_cont, class: 'form-control', placeholder: 'ユーザー名で検索' %>
      </div>
      <div class="col-md-4">
        <%= f.label :post_title_cont, '投稿タイトル検索' %>
        <%= f.search_field :post_title_cont, class: 'form-control', placeholder: '投稿タイトルで検索' %>
      </div>
    </div>
    <div class="mb-3">
      <%= f.submit '検索', class: 'btn btn-primary' %>
      <%= link_to 'リセット', admin_comments_path, class: 'btn btn-secondary' %>
    </div>
  <% end %>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>コメント内容</th>
        <th>投稿者</th>
        <th>投稿</th>
        <th>作成日</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody>
      <% @comments.each do |comment| %>
        <tr>
          <td><%= comment.id %></td>
          <td><%= truncate(comment.body, length: 50) %></td>
          <td><%= link_to comment.user.name, admin_user_path(comment.user) %></td>
          <td><%= link_to truncate(comment.post.title, length: 30), post_path(comment.post) %></td>
          <td><%= comment.created_at.strftime('%Y/%m/%d %H:%M') %></td>
          <td>
            <%= link_to '削除', admin_comment_path(comment), method: :delete, data: { confirm: '本当に削除しますか？' }, class: 'btn btn-sm btn-danger' %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <%= paginate @comments %>
</div>
